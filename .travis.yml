language: node_js
node_js:
- node
- '9'
- '8'
- '7'
- '6'
cache: yarn
env:
  matrix:
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main" LLVM_VERSION=4.0
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-5.0 main" LLVM_VERSION=5.0
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-6.0 main" LLVM_VERSION=6.0
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty main" LLVM_VERSION=7
before_install:
- sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
- wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key|sudo apt-key add -
- echo $LLVM_DEB | sudo tee -a /etc/apt/sources.list
- sudo apt-get update -qq
- sudo apt-get install libedit-dev llvm-$LLVM_VERSION llvm-$LLVM_VERSION-dev
- npm config set cmake_LLVM_DIR $(llvm-config-$LLVM_VERSION --cmakedir)
deploy:
  provider: npm
  email: micha@famreiser.ch
  api_key:
    secure: wdY+OMihd0Ro2MoSqFJVJkNeejqbA5FwDCrbWSZ0hDyL2UXvmlh76hgCJxtiOtUCee9StLwgGfBaxuRHWIyzUOGgzCNx8G8JnguaegdGPkAITjJZvrwztyZVIWzUjHIPLHScq/Y3uXd+vcV8RtSlmVIFTC4wYU4bQJpBsNLHzHbIQHqhGig0UtsXDJXVnSzFN598+xiAagp7USKNPPReRoRE8fMFzLudQ3WuvJxQY5u/d4pgpUua3S93mjFgmAyovgkXRyWzKJqeNPn6JvqGpR7guWdNGEAZdj4i7X4VpPEZ6zqMmY5P4iE1fiEXYplyQcZZr8UqdZZtU4xr3fcoOa252GD3D3G4yDS0Uc3GISbUOQFCfXUgr++ua4WvW0Wy55HKRzmwDfDt3aXVgEih9aW6+gDeIfsMabiTzlyEivzxFlvck6QAtPEGGcnXZg9RcU2NrwAVZKoYAAtxlMoksz1kZR3FCvcyyfoZEf7nCmeLh6avra1pUfH2Xrug+yqLpdwDE4l99YPPLLzZPiXbnZdou9jlSOJz8WIvB6voNPAKiqfFCj+xHbV3wdGUVig2ffytSFFoBMrjkVMO1SHA5iV1yiMZMnbtuJ8bHxNxztfj5Ac32DDpt1knwaNmULt+TlYsY+VdSqoHxZdIKoCunhliC/Z7sdtVJ5T3zurVVfQ=
  on:
    tags: true
    repo: MichaReiser/llvm-node
