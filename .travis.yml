language: node_js
node_js:
- node
- '9'
- '8'
- '7'
- '6'
cache: yarn
env:
  matrix:
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main" LLVM_VERSION=4.0
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-5.0 main" LLVM_VERSION=5.0
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-6.0 main" LLVM_VERSION=6.0
  - LLVM_DEB="deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty main" LLVM_VERSION=7
before_install:
- sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
- wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key|sudo apt-key add -
- echo $LLVM_DEB | sudo tee -a /etc/apt/sources.list
- sudo apt-get update -qq
- sudo apt-get install libedit-dev llvm-$LLVM_VERSION llvm-$LLVM_VERSION-dev
- npm config set cmake_LLVM_DIR $(llvm-config-$LLVM_VERSION --cmakedir)
deploy:
  provider: npm
  email: micha@famreiser.ch
  api_key:
    secure: WrHsFjexb+mNaQ3kdYKr5xYpHcQ7ipZPbs4weRtNgrOGbCJgImeKPE114Dd1Ks5gj6X3ZIdCRywW5Vn8BhHr91ee3Tfp7iY8tB0xOkpa2B63xFUI07pVurI1S2CrSxI602lj0kCnnJLNe1sDyHb7ENvLWh04wpzrGm5zlZe176MyWHDrHcPHitYdYOj401eucRY9F3Bt1tLIBqmEaf4zrX8p4jW3tha9MvM3/ActMcWN+oAIWYlSpJ8hmyCLm73e/NmIsWkC9BYv+eQyKOCSE6dOgj9+APpeMMl8NW/wGv693vPsV64OrQfo0iYdFrOKNaXjZcQDIUwzl8M55GWusU5KJOQgP4apCGKtBqLkY+tH44y0vb/xPzKIA36tAET1/B3PUMQEsotD9x8jMmGmADe8GfFZTB0kWQ4U0PD+Pcs7MC//vQJL5DJuQljpSIMYYESHLobAhp8jb2akrrHOTC0W0sxGZYPCBfiacSOR4zjYczOr4tw1EII2aflOiF2UtLXqsRfhNv+yEorWEaQ4XpHXtsg/1MY14p/pAkjiD2OAmsXOtvP7o/gqTHlPVUDONgoDNlNEuThlYO3G5mVm5EU1LMOy2y7oBfiaHmtrIP5bBW1n8he/P4yvT3F7rGXo4OCbeDO23YJaFHSUtvJjdMlVX+tr/HCcRD6L6wSrXPs=
  on:
    tags: true
    repo: MichaReiser/llvm-node
